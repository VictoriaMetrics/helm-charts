
{{- $Values := (.helm).Values | default .Values }}
{{- $multicluster := ((($Values.grafana).sidecar).dashboards).multicluster | default false }}
{{- $defaultDatasource := "prometheus" -}}
{{- $clusterLabel := ($Values.global).clusterLabel | default "cluster" }}
{{- range (((($Values.grafana).sidecar).datasources).victoriametrics | default list) }}
  {{- if and .isDefault .type }}{{ $defaultDatasource = .type }}{{- end }}
{{- end }}
title: Kubernetes / Kubelet
templating:
  list:
  - name: datasource
    label: Data source
    type: datasource
    query: {{ $defaultDatasource }}
    current:
      selected: true
      text: default
      value: default
    regex: ""
  - name: cluster
    label: cluster
    datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    type: {{ ternary "query" "constant" $multicluster }}
    query: {{ ternary (printf "label_values(up{job=\"kubelet\",metrics_path=\"/metrics\"}, %s)" $clusterLabel) ".*" $multicluster }}
    hide: {{ ternary 0 2 $multicluster }}
    refresh: 2
    sort: 1
  - name: instance
    label: instance
    includeAll: true
    datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    type: query
    query: {{ printf "label_values(up{job=\"kubelet\",metrics_path=\"/metrics\",%s=~\"$cluster\"}, instance)" $clusterLabel }}
    refresh: 2
editable: false
timezone: {{ default "UTC" ($Values.defaultDashboards).defaultTimezone }}
tags:
- kubernetes-mixin
- vm-k8s-stack
panels:
- title: Running Kubelets
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(kubelet_node_name{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\"}) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 0
    "y": 0
  id: 1
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Running Pods
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(kubelet_running_pods{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 4
    "y": 0
  id: 2
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Running Containers
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(kubelet_running_containers{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 8
    "y": 0
  id: 3
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Actual Volume Count
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(volume_manager_total_volumes{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",state=\"actual_state_of_world\"}) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 12
    "y": 0
  id: 4
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Desired Volume Count
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(volume_manager_total_volumes{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",state=\"desired_state_of_world\"}) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 16
    "y": 0
  id: 5
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Config Error Count
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_node_config_error{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(%s)" $clusterLabel $clusterLabel }}
    instant: true
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      unit: none
  gridPos:
    h: 7
    w: 4
    x: 20
    "y": 0
  id: 6
  interval: 1m
  options:
    colorMode: none
  pluginVersion: v11.4.0
  type: stat
- title: Operation Rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_runtime_operations_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(operation_type,instance,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_type{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 0
    "y": 7
  id: 7
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Operation Error Rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_runtime_operations_errors_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_type,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_type{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 12
    "y": 7
  id: 8
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Operation Duration 99th quantile
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_runtime_operations_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_type,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_type{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 24
    x: 0
    "y": 14
  id: 9
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Pod Start Rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_pod_start_duration_seconds_count{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} pod'
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_pod_worker_duration_seconds_count{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} worker'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 0
    "y": 21
  id: 10
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Pod Start Duration
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_pod_start_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} pod'
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_pod_worker_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} worker'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 12
    x: 12
    "y": 21
  id: 11
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Storage Operation Rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(storage_operation_duration_seconds_count{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_name,volume_plugin,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_name{{`}}`}} {{`{{`}}volume_plugin{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 0
    "y": 28
  id: 12
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Storage Operation Error Rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(storage_operation_errors_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_name,volume_plugin,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_name{{`}}`}} {{`{{`}}volume_plugin{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 12
    "y": 28
  id: 13
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Storage Operation Duration 99th quantile
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(storage_operation_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_name,volume_plugin,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_name{{`}}`}} {{`{{`}}volume_plugin{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 24
    x: 0
    "y": 35
  id: 14
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Cgroup manager operation rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_cgroup_manager_duration_seconds_count{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_type,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}operation_type{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 0
    "y": 42
  id: 15
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Cgroup manager 99th quantile
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_cgroup_manager_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,operation_type,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}operation_type{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 12
    x: 12
    "y": 42
  id: 16
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: PLEG relist rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(kubelet_pleg_relist_duration_seconds_count{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,%s)" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 12
    x: 0
    "y": 49
  id: 17
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: PLEG relist interval
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_pleg_relist_interval_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 12
    x: 12
    "y": 49
  id: 18
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: PLEG relist duration
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(kubelet_pleg_relist_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 24
    x: 0
    "y": 56
  id: 19
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: RPC rate
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(rest_client_requests_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",code=~\"2..\"}[$__rate_interval])) by(%s)" $clusterLabel $clusterLabel }}
    legendFormat: 2xx
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(rest_client_requests_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",code=~\"3..\"}[$__rate_interval])) by(%s)" $clusterLabel $clusterLabel }}
    legendFormat: 3xx
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(rest_client_requests_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",code=~\"4..\"}[$__rate_interval])) by(%s)" $clusterLabel $clusterLabel }}
    legendFormat: 4xx
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "sum(rate(rest_client_requests_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\",code=~\"5..\"}[$__rate_interval])) by(%s)" $clusterLabel $clusterLabel }}
    legendFormat: 5xx
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: ops
  gridPos:
    h: 7
    w: 24
    x: 0
    "y": 63
  id: 20
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Request duration 99th quantile
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "histogram_quantile(0.99, sum(rate(rest_client_request_duration_seconds_bucket{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])) by(instance,verb,le,%s))" $clusterLabel $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}} {{`{{`}}verb{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: s
  gridPos:
    h: 7
    w: 24
    x: 0
    "y": 70
  id: 21
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Memory
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "process_resident_memory_bytes{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}" $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: bytes
  gridPos:
    h: 7
    w: 8
    x: 0
    "y": 77
  id: 22
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: CPU usage
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "rate(process_cpu_seconds_total{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}[$__rate_interval])" $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: short
  gridPos:
    h: 7
    w: 8
    x: 8
    "y": 77
  id: 23
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
- title: Goroutines
  targets:
  - datasource:
      type: {{ $defaultDatasource }}
      uid: ${datasource}
    expr: {{ printf "go_goroutines{%s=~\"$cluster\",job=\"kubelet\",metrics_path=\"/metrics\",instance=~\"$instance\"}" $clusterLabel }}
    legendFormat: '{{`{{`}}instance{{`}}`}}'
  datasource:
    type: datasource
    uid: -- Mixed --
  fieldConfig:
    defaults:
      custom:
        fillOpacity: 10
        showPoints: never
        spanNulls: true
      unit: short
  gridPos:
    h: 7
    w: 8
    x: 16
    "y": 77
  id: 24
  interval: 1m
  options:
    legend:
      asTable: true
      calcs:
      - lastNotNull
      displayMode: table
      placement: right
      showLegend: true
    tooltip:
      mode: single
  pluginVersion: v11.4.0
  type: timeseries
condition: {{ "($Values.kubelet).enabled" }}
links:
- asDropdown: true
  includeVars: true
  keepTime: true
  tags:
  - kubernetes-mixin
  targetBlank: false
  title: Kubernetes
  type: dashboards
refresh: 10s
schemaVersion: 39
time:
  from: now-1h
  to: now
uid: 3138fa155d5915769fbded898ac09fd9
